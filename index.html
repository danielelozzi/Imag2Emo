<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EEG-Based Emotion Recognition: The Role of Subjectivity</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f8fafc; /* slate-50 */
        }
        .section-title {
            @apply text-3xl font-bold text-slate-800 mb-6 text-center;
        }
        .card {
            @apply bg-white rounded-xl shadow-md p-6 hover:shadow-lg transition-shadow duration-300;
        }
        .nav-link {
            @apply text-slate-600 hover:text-slate-900 font-medium transition-colors duration-300;
        }
        .chart-container {
            position: relative;
            height: 400px;
            width: 100%;
        }
        .interactive-dashboard select {
            @apply w-full bg-slate-100 border-slate-300 rounded-md p-2 transition-all duration-300;
        }
        .interactive-dashboard select:disabled {
            @apply bg-slate-200 text-slate-400 cursor-not-allowed;
        }
    </style>
</head>
<body class="text-slate-700">

    <!-- Header & Navigation -->
    <header class="bg-white/80 backdrop-blur-md sticky top-0 z-50 shadow-sm">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div class="text-2xl font-bold text-slate-800">
                EEG Emotion Project
            </div>
            <div class="hidden md:flex space-x-8">
                <a href="#home" class="nav-link">Home</a>
                <a href="#dashboard" class="nav-link">Dashboard</a>
                <a href="#interactive-dashboard" class="nav-link">Interactive Dashboard</a>
                <a href="#methodology" class="nav-link">Methodology</a>
                <a href="#conclusion" class="nav-link">Conclusion</a>
            </div>
            <button id="mobile-menu-button" class="md:hidden text-slate-800 focus:outline-none">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7"></path></svg>
            </button>
        </nav>
        <!-- Mobile Menu -->
        <div id="mobile-menu" class="hidden md:hidden px-6 pb-4">
            <a href="#home" class="block py-2 nav-link">Home</a>
            <a href="#dashboard" class="block py-2 nav-link">Dashboard</a>
            <a href="#interactive-dashboard" class="block py-2 nav-link">Interactive Dashboard</a>
            <a href="#methodology" class="block py-2 nav-link">Methodology</a>
            <a href="#conclusion" class="block py-2 nav-link">Conclusion</a>
        </div>
    </header>

    <!-- Main Content -->
    <main class="container mx-auto px-6 py-12">

        <!-- Home Section -->
        <section id="home" class="text-center mb-24">
            <div class="max-w-4xl mx-auto">
                <h1 class="text-4xl md:text-5xl font-extrabold text-slate-900 mb-4 leading-tight">EEG-Based Emotion Recognition Beyond
Standardized Labels</h1>
                <p class="text-lg text-slate-600 mb-6">An investigation into the neural correlates of visual emotional processing and the critical role of personalized labels in Affective Computing.</p>
                <p class="text-sm text-slate-500 mb-8">By Daniele Lozzi, Enrico Mattei, Giuseppe Placidi, and Selina C. Wriessnegger</p>
                <div class="card">
                     <h3 class="text-xl font-semibold text-slate-800 mb-3">Abstract</h3>
                    <p class="text-left text-slate-600 leading-relaxed">This study investigates the Electroencephalogram (EEG) correlates of emotional responses to visual stimuli from the NAPS-BE and SFIP datasets. We found that Deep Learning (DL) models trained with the original dataset labels performed poorly. However, when the same models were trained using personalized labels from participants' own ratings, their accuracy in classifying emotional states improved dramatically. These findings underscore the highly subjective nature of emotional reactions and highlight the critical need for personalized data to advance EEG-based emotion recognition systems.</p>
                </div>
            </div>
        </section>

        <!-- Dashboard Section -->
        <section id="dashboard" class="mb-24">
            <h2 class="section-title">Results Dashboard</h2>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Methodology & Code Section -->
                <div class="card md:col-span-2">
                    <h3 class="text-xl font-semibold text-slate-800 mb-4">EEG Data Preprocessing Pipeline</h3>
                    <div class="flex flex-wrap items-center justify-center text-center gap-2">
                        <div class="p-3 bg-slate-100 rounded-lg">Signal Acquisition</div>
                        <div class="text-slate-400 font-bold text-2xl">&rarr;</div>
                        <div class="p-3 bg-slate-100 rounded-lg">1-100 Hz Filtering</div>
                        <div class="text-slate-400 font-bold text-2xl">&rarr;</div>
                        <div class="p-3 bg-slate-100 rounded-lg">PREP Pipeline</div>
                        <div class="text-slate-400 font-bold text-2xl">&rarr;</div>
                        <div class="p-3 bg-slate-100 rounded-lg">ICA (Extended Infomax)</div>
                        <div class="text-slate-400 font-bold text-2xl">&rarr;</div>
                        <div class="p-3 bg-slate-100 rounded-lg">Remove Artifacts (ICLabel)</div>
                         <div class="text-slate-400 font-bold text-2xl">&rarr;</div>
                        <div class="p-3 bg-slate-100 rounded-lg">4-64 Hz Filtering</div>
                         <div class="text-slate-400 font-bold text-2xl">&rarr;</div>
                        <div class="p-3 bg-slate-100 rounded-lg">Epoching (-1s to +3s)</div>
                    </div>
                </div>
                
                <!-- DL Architectures -->
                <div class="card md:col-span-2">
                    <h3 class="text-xl font-semibold text-slate-800 mb-4">Deep Learning Architectures</h3>
                    <p class="text-slate-600 mb-4">We employed a suite of state-of-the-art DL models designed for EEG signal processing to ensure a robust analysis.</p>
                    <ul class="list-disc list-inside space-y-2 text-slate-600">
                        <li><span class="font-semibold">EEGNetv4:</span> A compact CNN for EEG-based BCIs, effective at capturing temporal and spatial features.</li>
                        <li><span class="font-semibold">ContraNet:</span> A hybrid network designed for classifying EEG and EMG signals, especially with limited data.</li>
                        <li><span class="font-semibold">Conformer:</span> A model combining convolution and transformers, tailored for motor imagery and emotion paradigms.</li>
                        <li><span class="font-semibold">EEGVIT:</span> A Vision Transformer (ViT) based architecture adapted for visual task EEG data.</li>
                        <li><span class="font-semibold">EEG-deformer:</span> A dense convolutional transformer for detecting cognitive attention and mental workload.</li>
                    </ul>
                </div>

            </div>
        </section>
        
        <!-- Interactive Dashboard Section -->
        <section id="interactive-dashboard" class="mb-24 interactive-dashboard">
            <h2 class="section-title"></h2>
            <div class="card">
                <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
                    <div>
                        <label for="dataset-select" class="block text-sm font-medium text-slate-600 mb-1">Dataset</label>
                        <select id="dataset-select">
                            <option value="DEAP">DEAP</option>
                            <option value="Imag2Emo">Imag2Emo (GRAZ)</option>
                        </select>
                    </div>
                    <div>
                        <label for="label-type-select" class="block text-sm font-medium text-slate-600 mb-1">Label Type</label>
                        <select id="label-type-select">
                            <option value="PUBLIC">Public</option>
                            <option value="PRIVATE">Private</option>
                        </select>
                    </div>
                    <div>
                        <label for="dimension-select" class="block text-sm font-medium text-slate-600 mb-1">Dimension</label>
                        <select id="dimension-select">
                            <option value="valence">Valence</option>
                            <option value="arousal">Arousal</option>
                            <option value="hns" id="hns-option" hidden>HNS (Discrete)</option>
                        </select>
                    </div>
                    <div>
                        <label for="model-select" class="block text-sm font-medium text-slate-600 mb-1">Model</label>
                        <select id="model-select">
                            <option value="EEGNetv4">EEGNetv4</option>
                            <option value="EEGDeformer">EEGDeformer</option>
                            <option value="ContraNet">ContraNet</option>
                            <option value="Conformer">Conformer</option>
                            <option value="EEGViT">EEGViT</option>
                        </select>
                    </div>
                </div>
                <div id="results-container" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Results will be dynamically loaded here -->
                </div>
            </div>
        </section>

        <!-- Conclusion Section -->
        <section id="conclusion" class="text-center">
             <h2 class="section-title">Conclusion & Future Directions</h2>
             <div class="max-w-4xl mx-auto">
                <div class="card">
                     <p class="text-lg text-slate-600 leading-relaxed mb-6">Our study conclusively demonstrates that the neural response recorded via EEG is more closely correlated with a person's inner subjective experience than with the standardized classification of a visual stimulus. Integrating this subjectivity is not an obstacle, but the <span class="font-bold">fundamental requirement</span> for creating accurate, effective, and truly human-centered affective technologies.</p>
                    <h3 class="text-xl font-semibold text-slate-800 mb-3">Future Work</h3>
                    <p class="text-slate-600">To improve generalizability and replicability, future studies should not only integrate subjective self-assessments but also adopt standardized data formats like <span class="font-mono bg-slate-100 px-2 py-1 rounded">BIDS</span> (Brain Imaging Data Structure) and <span class="font-mono bg-slate-100 px-2 py-1 rounded">DICOM</span>. This will facilitate more efficient dataset sharing and the development of more robust, generalizable emotion recognition models.</p>
                </div>
            </div>
        </section>

    </main>

    <!-- Footer -->
    <footer class="bg-slate-800 text-slate-300 mt-24">
        <div class="container mx-auto px-6 py-8 text-center">
            <p>&copy; 2024 EEG Emotion Recognition Project. All rights reserved.</p>
            <p class="text-sm text-slate-400 mt-2">This website is a representation of the research paper "Methodological limitations of emotion recognition using EEG signals".</p>
        </div>
    </footer>

    <script>
        // Mobile Menu Toggle
        const mobileMenuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        mobileMenuButton.addEventListener('click', () => {
            mobileMenu.classList.toggle('hidden');
        });

        // --- Interactive Dashboard Logic ---
        const datasetSelect = document.getElementById('dataset-select');
        const labelTypeSelect = document.getElementById('label-type-select');
        const dimensionSelect = document.getElementById('dimension-select');
        const modelSelect = document.getElementById('model-select');
        const resultsContainer = document.getElementById('results-container');
        const hnsOption = document.getElementById('hns-option');

        function getDimensionFolder(dataset, dimension, labelType) {
            // Logica per costruire i nomi delle cartelle in base alle selezioni.
            // Deve corrispondere esattamente alla struttura delle cartelle dei risultati.
            if (dataset === 'DEAP') {
                // Esempio: DEAP, PRIVATE, arousal -> arousal_privata
                const suffix = labelType === 'PRIVATE' ? 'privata' : 'pubblica';
                return `${dimension}_${suffix}`;
            }
            if (dataset === 'Imag2Emo') { // Corresponds to GRAZ
                if (dimension === 'hns') {
                    // Esempio: Imag2Emo, PRIVATE, hns -> discrete_emotions
                    return labelType === 'PRIVATE' ? 'discrete_emotions' : 'hns_pubblico';
                } else {
                    // Esempio: Imag2Emo, PRIVATE, valence -> rate_valence_privata
                    // Esempio: Imag2Emo, PUBLIC, valence -> valence_pubblico
                    const suffix = labelType === 'PRIVATE' ? 'privata' : 'pubblico';
                    const prefix = (labelType === 'PRIVATE' && dimension !== 'hns') ? 'rate_' : '';
                    return `${prefix}${dimension}_${suffix}`;
                }
            }
            return ''; // Fallback
        }

        function parseCSVToReportObject(csvText) {
            const report = {};
            const lines = csvText.trim().split('\n');
            const dataLines = lines.slice(1); // Skip header
            dataLines.forEach(line => {
                const [key, precision, recall, f1, support] = line.split(',');
                if (key && key.trim()) {
                    report[key.trim()] = {
                        precision: parseFloat(precision), recall: parseFloat(recall),
                        'f1-score': parseFloat(f1), support: parseInt(support, 10)
                    };
                }
            });
            return report;
        }
        
        function renderReportTable(reportData, containerId) {
            const container = document.getElementById(containerId);
            if (!reportData || typeof reportData !== 'object') {
                container.innerHTML = '<p class="text-center text-slate-500">Could not render report table.</p>';
                return;
            }
            const allLabels = Object.keys(reportData);

            let tableHtml = `<div class="overflow-x-auto"><table class="w-full text-sm text-left">
                <thead class="bg-slate-100"><tr>
                    <th class="p-2"></th><th class="p-2">Precision</th><th class="p-2">Recall</th><th class="p-2">F1-Score</th><th class="p-2">Support</th>
                </tr></thead><tbody>`;

            allLabels.forEach(label => {
                const stats = reportData[label];
                const isAvg = label.includes('avg');
                tableHtml += `<tr class="border-b ${isAvg ? 'bg-slate-50 font-bold' : ''}">
                    <td class="p-2">${label}</td>
                    <td class="p-2">${stats.precision.toFixed(2)}</td>
                    <td class="p-2">${stats.recall.toFixed(2)}</td>
                    <td class="p-2">${stats['f1-score'].toFixed(2)}</td>
                    <td class="p-2">${stats.support}</td>
                </tr>`;
            });
            
            tableHtml += `</tbody></table></div>`;
            container.innerHTML = tableHtml;
        }

        function updateDashboard() {
            const dataset = datasetSelect.value;
            const labelType = labelTypeSelect.value;
            const dimension = dimensionSelect.value;
            const model = modelSelect.value;
            const datasetFolder = dataset === 'Imag2Emo' ? 'GRAZ' : 'DEAP';
            
            // Costruisce il percorso relativo che verrà passato a get_data.php
            const dimensionFolder = getDimensionFolder(dataset, dimension, labelType);
            const basePath = `${datasetFolder}/${labelType}/${dimensionFolder}/k_simple/${model}/scaling_ON`;

            // URL per l'immagine delle curve
            const imageUrl = `get_data.php?path=${encodeURIComponent(basePath + '/avg_curves.png')}`;
            // URL per il report CSV
            const reportUrl = `get_data.php?path=${encodeURIComponent(basePath + '/summary_metrics_per_classe.csv')}`;

            resultsContainer.innerHTML = `
                <div class="card flex justify-center items-center relative">
                    <h3 class="text-xl font-semibold text-slate-800 mb-4 absolute top-6">Curves</h3>
                    <img src="${imageUrl}" alt="Curves" class="rounded-lg max-w-full h-auto" onerror="this.src='https://placehold.co/600x400/f1f5f9/94a3b8?text=Image+Not+Found'; this.onerror=null;">
                </div>
                <div class="card col-span-1 md:col-span-2">
                    <h3 class="text-xl font-semibold text-slate-800 mb-4">Classification Report</h3>
                    <div id="report-container"><p class="text-center text-slate-500">Loading report...</p></div>
                </div>
            `;

            // Esegue la fetch per recuperare e renderizzare il report
            fetch(reportUrl)
                .then(response => {
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    return response.text();
                })
                .then(csvText => {
                    const reportData = parseCSVToReportObject(csvText);
                    renderReportTable(reportData, 'report-container');
                })
                .catch(error => {
                    console.error("Error fetching report:", error);
                    document.getElementById('report-container').innerHTML = `<p class="text-center text-amber-600">Could not load report data for this selection.</p>`;
                });
        }

        function handleDatasetChange() {
            if (datasetSelect.value === 'DEAP') {
                hnsOption.hidden = true;
                if (dimensionSelect.value === 'hns') {
                    dimensionSelect.value = 'valence';
                }
            } else { // Imag2Emo
                hnsOption.hidden = false;
            }
            updateDashboard();
        }

        datasetSelect.addEventListener('change', handleDatasetChange);
        labelTypeSelect.addEventListener('change', updateDashboard);
        dimensionSelect.addEventListener('change', updateDashboard);
        modelSelect.addEventListener('change', updateDashboard);

        // Initial setup
        handleDatasetChange();

    </script>
</body>
</html>
